{"version":3,"sources":["registro.js"],"names":["eventos","resumen","document","querySelector","querySelectorAll","forEach","boton","addEventListener","seleccionarEventos","e","length","target","disabled","id","dataset","titulo","parentElement","textContent","Swal","fire","title","icon","mostrarEventos","firstChild","removeChild","limpiarHhtml","evento","eventoDOM","createElement","classList","add","botonEliminar","innerHTML","onclick","filter","eliminarEvento","append","appendChild","noRegistro","async","preventDefault","regaloId","value","eventosId","map","datos","FormData","url","respuesta","fetch","method","body","resultado","json","res","then","location","href","token","reload"],"mappings":"AAAA,MACI,IAAIA,EAAU,GACd,MAAMC,EAAUC,SAASC,cAAc,yBACvC,GAAGF,EAAS,CACaC,SAASE,iBAAiB,oBAClCC,QAASC,GAASA,EAAMC,iBAAiB,QAASC,IAO/D,SAASA,EAAmBC,GAErBT,EAAQU,OAAS,GAChBD,EAAEE,OAAOC,UAAW,EACpBZ,EAAU,IAAIA,EAAS,CACnBa,GAAIJ,EAAEE,OAAOG,QAAQD,GACrBE,OAAQN,EAAEE,OAAOK,cAAcb,cAAc,mBAAmBc,eAGpEC,KAAKC,KAAK,CACNC,MAAO,8BACPC,KAAM,YAIdC,IAEJ,SAASA,IAIL,GA4BJ,WACI,KAAMrB,EAAQsB,YACVtB,EAAQuB,YAAYvB,EAAQsB,YAhChCE,GAEGzB,EAAQU,OAAS,EAChBV,EAAQK,QAASqB,IACb,MAAMC,EAAYzB,SAAS0B,cAAc,OACzCD,EAAUE,UAAUC,IAAI,wBAExB,MAAMf,EAASb,SAAS0B,cAAc,MACtCb,EAAOc,UAAUC,IAAI,wBACrBf,EAAOE,YAAcS,EAAOX,OAE5B,MAAMgB,EAAgB7B,SAAS0B,cAAc,UAC7CG,EAAcF,UAAUC,IAAI,0BAC5BC,EAAcC,UAAY,oCAC1BD,EAAcE,QAAU,YAqBpC,SAAwBpB,GACpBb,EAAUA,EAAQkC,OAAQR,GAAUA,EAAOb,IAAMA,GAC5BX,SAASC,cAAc,aAAaU,OAC5CD,UAAW,EACxBU,IAxBYa,CAAeT,EAAOb,KAG1Bc,EAAUS,OAAOrB,EAAQgB,GAGzB9B,EAAQoC,YAAYV,SAErB,CACH,MAAMW,EAAapC,SAAS0B,cAAc,KAC1CU,EAAWrB,YAAc,oDACzBqB,EAAWT,UAAUC,IAAI,uBACzB7B,EAAQoC,YAAYC,IAnDPpC,SAASC,cAAc,aAC/BI,iBAAiB,UAgE9BgC,eAAgC9B,GAC5BA,EAAE+B,iBACF,MAAMC,EAAWvC,SAASC,cAAc,WAAWuC,MAC7CC,EAAY3C,EAAQ4C,IAAKlB,GAAUA,EAAOb,IAEhD,GAAwB,IAArB8B,EAAUjC,QAA6B,KAAb+B,EACzBvB,KAAKC,KAAK,CACNC,MAAO,uCACPC,KAAM,gBAEP,CACH,MAAMwB,EAAQ,IAAIC,SAClBD,EAAMT,OAAO,aAAcO,GAC3BE,EAAMT,OAAO,YAAaK,GAC1B,MAAMM,EAAM,mCACNC,QAAkBC,MAAMF,EAAK,CAC/BG,OAAQ,OACRC,KAAMN,IAEJO,QAAkBJ,EAAUK,OAC/BD,EAAUA,UAAUE,IACnBpC,KAAKC,KAAK,CACNC,MAAO,6FACPC,KAAM,YACPkC,KAAM,IAAMC,SAASC,KAAO,cAAcL,EAAUM,OAEvDxC,KAAKC,KAAK,CACNC,MAAO,gBACPC,KAAM,UACPkC,KAAM,IAAMC,SAASG,cA3FpCrC,MAVR","file":"registro.js","sourcesContent":["(() => {\r\n    let eventos = [];\r\n    const resumen = document.querySelector('#registro-bar-resumen');\r\n    if(resumen) {\r\n        const eventosBoton = document.querySelectorAll('.evento__agregar');\r\n        eventosBoton.forEach( boton => boton.addEventListener('click', seleccionarEventos));\r\n\r\n        const formRegistro = document.querySelector('#registro');\r\n        formRegistro.addEventListener('submit', submitFormulario);\r\n\r\n        mostrarEventos();\r\n\r\n        function seleccionarEventos(e) {\r\n            // Deshabilitar el evento;\r\n            if(eventos.length < 5) {\r\n                e.target.disabled = true;\r\n                eventos = [...eventos, {\r\n                    id: e.target.dataset.id,\r\n                    titulo: e.target.parentElement.querySelector('.evento__nombre').textContent,\r\n                }];\r\n            } else {\r\n                Swal.fire({\r\n                    title: 'Sólo un máximo de 5 eventos',\r\n                    icon: 'warning'\r\n                });\r\n            }\r\n\r\n            mostrarEventos();\r\n        }\r\n        function mostrarEventos() {\r\n            // Limpiar el html\r\n            limpiarHhtml();\r\n\r\n            if(eventos.length > 0) {\r\n                eventos.forEach( evento => {\r\n                    const eventoDOM = document.createElement('DIV');\r\n                    eventoDOM.classList.add('registro-bar__evento');\r\n\r\n                    const titulo = document.createElement('H3');\r\n                    titulo.classList.add('registro-bar__nombre');\r\n                    titulo.textContent = evento.titulo;\r\n\r\n                    const botonEliminar = document.createElement('BUTTON');\r\n                    botonEliminar.classList.add('registro-bar__eliminar');\r\n                    botonEliminar.innerHTML = '<i class=\"fa-solid fa-trash\"></i>'\r\n                    botonEliminar.onclick = function () {\r\n                        eliminarEvento(evento.id);\r\n                    }\r\n\r\n                    eventoDOM.append(titulo, botonEliminar);\r\n\r\n                    // Renderizar en el html\r\n                    resumen.appendChild(eventoDOM);\r\n                })\r\n            } else {\r\n                const noRegistro = document.createElement('P');\r\n                noRegistro.textContent = \"No hay eventos, añade hasta 5 del lado izquierdo \";\r\n                noRegistro.classList.add('registro-bar__texto');\r\n                resumen.appendChild(noRegistro);\r\n            }\r\n        }\r\n        function limpiarHhtml() {\r\n            while(resumen.firstChild) {\r\n                resumen.removeChild(resumen.firstChild);\r\n            }\r\n        }\r\n        function eliminarEvento(id) {\r\n            eventos = eventos.filter( evento => evento.id != id);\r\n            const botonAgregar = document.querySelector(`[data-id=\"${id}\"]`);\r\n            botonAgregar.disabled = false;\r\n            mostrarEventos();\r\n        }\r\n        async function submitFormulario(e) {\r\n            e.preventDefault();\r\n            const regaloId = document.querySelector('#regalo').value;\r\n            const eventosId = eventos.map( evento => evento.id);\r\n\r\n            if(eventosId.length === 0 || regaloId === \"\"){\r\n                Swal.fire({\r\n                    title: 'Elige al menos un Evento y un regalo',\r\n                    icon: 'warning'\r\n                }); \r\n            } else {\r\n                const datos = new FormData();\r\n                datos.append('id_eventos', eventosId);\r\n                datos.append('id_regalo', regaloId);\r\n                const url = '/finalizar-registro/conferencias';\r\n                const respuesta = await fetch(url, {\r\n                    method: \"POST\",\r\n                    body: datos,\r\n                });\r\n                const resultado = await respuesta.json();\r\n                if(resultado.resultado.res) {\r\n                    Swal.fire({\r\n                        title: 'Tus conferencias se han almacenado y tu registro fue exitoso.\\n Te esperamos en DevWebCamp',\r\n                        icon: 'success'\r\n                    }).then( () => location.href = `/boleto?id=${resultado.token}`);\r\n                } else {\r\n                    Swal.fire({\r\n                        title: 'Hubo un error',\r\n                        icon: 'error'\r\n                    }).then( () => location.reload()); \r\n                }\r\n\r\n            }\r\n        }\r\n\r\n    }\r\n})();"]}