{"version":3,"sources":["tareas.js"],"names":["mostrarAlerta","mensaje","tipo","referencia","alertaPrevia","document","querySelector","remove","alerta","createElement","innerHTML","referenceBox","parentElement","insertBefore","setTimeout","obtenerUrlProyecto","proyectoParams","URLSearchParams","window","location","search","Object","fromEntries","url","addEventListener","modal","classList","add","appendChild","event","preventDefault","target","contains","tarea","value","trim","async","datos","FormData","append","JSON","stringify","proyecto","response","fetch","method","body","data","text","console","log","res","err","agregarTarea","submitNuevaTarea"],"mappings":"AAAA,MA+DI,SAASA,EAAcC,EAASC,EAAMC,GAClC,MAAMC,EAAeC,SAASC,cAAc,UACzCF,GACCA,EAAaG,SAEjB,MAAMC,EAASH,SAASI,cAAc,OACtCD,EAAOE,UAAY,kEAEGR,4BACRD,0DAMd,MAAMU,EAAeN,SAASC,cAAc,GAAGH,GAC/CQ,EAAaC,cAAcC,aAAaL,EAAQG,GAGhDG,WAAW,KACPN,EAAOD,UACR,KAkCP,SAASQ,IACL,MAAMC,EAAiB,IAAIC,gBAAgBC,OAAOC,SAASC,QAE3D,OADiBC,OAAOC,YAAYN,GACpBO,IAvHDlB,SAASC,cAAc,kBAC/BkB,iBAAiB,SAE5B,WACI,MAAMC,EAAQpB,SAASI,cAAc,OACrCgB,EAAMC,UAAUC,IAAI,SACpBF,EAAMf,UAAY,2uBAmBlBL,SAASC,cAAc,QAAQsB,YAAYH,GAC3CX,WAAW,KACMT,SAASC,cAAc,SAC/BoB,UAAUC,IAAI,WACpB,IAEHF,EAAMD,iBAAiB,QAASK,IAC5BA,EAAMC,iBACN,MAAMJ,EAAYG,EAAME,OAAOL,UAC/B,GAAGA,EAAUM,SAAS,iBAAmBN,EAAUM,SAAS,SAAU,CACrD3B,SAASC,cAAc,SAC/BoB,UAAUC,IAAI,UACnBb,WAAW,KACPW,EAAMlB,UACP,KAEJmB,EAAUM,SAAS,uBAM9B,WACI,MAAMC,EAAQ5B,SAASC,cAAc,UAAU4B,MAAMC,OACxC,KAAVF,EAECjC,EACI,uCACA,MACA,4BA+BZoC,eAA4BH,GAExB,MAAMI,EAAQ,IAAIC,SAClBD,EAAME,OAAO,OAAQC,KAAKC,UAAU,CAChCR,MAAOA,EACPS,SAAU,CACNnB,IAAKR,QAKb,IACE,MAAMQ,EAAM,mBACNoB,QAAiBC,MAAMrB,EAAK,CAChCsB,OAAQ,OACRC,KAAMT,IAEFU,QAAaJ,EAASK,OAC5BC,QAAQC,IAAIH,GACRA,EAAKI,KACPnD,EACI,4BACA,MACA,4BAGN,MAAOoD,GACLH,QAAQC,IAAIE,IAvDZC,CAAapB,GAfTqB,SA5ChB","file":"tareas.js","sourcesContent":["(() => {\r\n    // Botón para mostrar el modar de agregar tarea\r\n    const nuevaTarea = document.querySelector('#agregar-tarea');\r\n    nuevaTarea.addEventListener('click', mostrarFormulario);\r\n\r\n    function mostrarFormulario() {\r\n        const modal = document.createElement('DIV');\r\n        modal.classList.add('modal');\r\n        modal.innerHTML = `\r\n            <form class=\"form nueva-tarea\">\r\n                <legend>Añade una tarea</legend>\r\n                <div class=\"campo\">\r\n                    <label class=\"bg-azul\">Tarea</label>\r\n                    <input\r\n                        type=\"text\"\r\n                        name=\"tarea\"\r\n                        placeholder=\"Añadir tarea\"\r\n                        id=\"tarea\"\r\n                        class=\"col-span-2\"\r\n                    />\r\n                </div>\r\n                <div class=\"opciones\">\r\n                    <input type=\"submit\" class=\"submit-nueva-tarea\" valuea=\"Añadir Tarea\"/>\r\n                    <button type=\"button\" class=\"cerrar-modal\" >Cancelar</button>\r\n                </div>\r\n            </form>\r\n        `;       \r\n        document.querySelector('body').appendChild(modal);\r\n        setTimeout(() => {\r\n            const form = document.querySelector('.form');\r\n            form.classList.add('animar');\r\n        }, 10);\r\n\r\n        modal.addEventListener('click', event => {\r\n            event.preventDefault();\r\n            const classList = event.target.classList;\r\n            if(classList.contains('cerrar-modal') || classList.contains('modal')) {\r\n                const form = document.querySelector('.form');\r\n                form.classList.add('cerrar');\r\n                setTimeout(() => {\r\n                    modal.remove();\r\n                }, 150);\r\n            }\r\n            if(classList.contains('submit-nueva-tarea')) {\r\n                submitNuevaTarea();\r\n            }\r\n        })\r\n    }\r\n\r\n    function submitNuevaTarea() {\r\n        const tarea = document.querySelector('#tarea').value.trim();\r\n        if(tarea === '') {\r\n            // Mostrar alerta de error\r\n            mostrarAlerta( \r\n                \"El nombre de la tarea es Obligatorio\", \r\n                \"err\",\r\n                \".form.nueva-tarea .campo\"\r\n            );\r\n        } else {\r\n            agregarTarea(tarea);\r\n        }\r\n    }\r\n\r\n    function mostrarAlerta(mensaje, tipo, referencia) {\r\n        const alertaPrevia = document.querySelector('.alert');\r\n        if(alertaPrevia) {\r\n            alertaPrevia.remove();\r\n        };\r\n        const alerta = document.createElement('DIV');\r\n        alerta.innerHTML = `\r\n            <div class=\"alert\">\r\n                <div class=\"${tipo}\">\r\n                    ${mensaje}\r\n                </div>\r\n            </div>\r\n        `;\r\n\r\n        // Inserta antes de la referencia\r\n        const referenceBox = document.querySelector(`${referencia}`);\r\n        referenceBox.parentElement.insertBefore(alerta, referenceBox);\r\n\r\n        // Eliminar elemento\r\n        setTimeout(() => {\r\n            alerta.remove();\r\n        }, 5000);\r\n    }\r\n\r\n    async function agregarTarea(tarea) {\r\n        // Construir la petición\r\n        const datos = new FormData();\r\n        datos.append('data', JSON.stringify({\r\n            tarea: tarea,\r\n            proyecto: {\r\n                url: obtenerUrlProyecto()\r\n            }\r\n        }));\r\n        \r\n\r\n        try {\r\n          const url = \"/api/task/create\";\r\n          const response = await fetch(url, {\r\n            method: \"POST\",\r\n            body: datos\r\n          });\r\n          const data = await response.text();\r\n          console.log(data);\r\n          if(!data.res) {\r\n            mostrarAlerta( \r\n                \"No se pudo crear la tarea\", \r\n                \"err\",\r\n                \".form.nueva-tarea .campo\"\r\n            );\r\n          }\r\n        } catch (err) {\r\n            console.log(err);\r\n        }\r\n    }\r\n\r\n    function obtenerUrlProyecto() {\r\n        const proyectoParams = new URLSearchParams(window.location.search);\r\n        const proyecto = Object.fromEntries(proyectoParams);\r\n        return proyecto.url;\r\n    }\r\n})();"]}