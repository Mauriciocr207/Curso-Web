const e={inicial:1,final:3,current:1},t={id:"",nombre:"",fecha:"",hora:"",servicios:{}};function c(){console.log("holaa"),o(),s(),r(),i(),l(),u(),m(),t.nombre=document.querySelector("#nombre").value,t.id=document.querySelector("#id").value}function a(e){document.querySelectorAll(".seccion").forEach(e=>{e.classList.remove("mostrar")});document.querySelector("#paso-"+e).classList.add("mostrar")}function n(e){document.querySelectorAll(".tabs button").forEach(t=>{t.classList.remove("actual"),e===parseInt(t.dataset.paso)&&t.classList.add("actual")})}function s(){const t=document.querySelector("#anterior"),c=document.querySelector("#siguiente");c.classList.remove("ocultar"),t.classList.remove("ocultar"),1===e.current?t.classList.add("ocultar"):3===e.current&&(c.classList.add("ocultar"),v())}function o(){document.querySelectorAll(".tabs button").forEach(t=>{t.addEventListener("click",t=>{e.current=parseInt(t.target.dataset.paso),a(e.current),s(),n(e.current)})})}function r(){document.querySelector("#anterior").addEventListener("click",()=>{e.current<=e.inicial?e.current=1:(e.current--,a(e.current),s(),n(e.current))})}function i(){document.querySelector("#siguiente").addEventListener("click",()=>{e.current>=e.final?e.current=3:(e.current++,a(e.current),s(),n(e.current))})}async function l(){try{const e="/api/servicios",t=await fetch(e);d(await t.json())}catch(e){p("Hubo un error al mostrar los servicios.","err","#servicios")}}function d(e=[]){e.forEach(e=>{const{id:c,nombre:a,precio:n}=e,s=document.createElement("P");s.classList.add("nombre-servicio"),s.textContent=a;const o=document.createElement("P");o.classList.add("precio-servicio"),o.textContent="$"+n;const r=document.createElement("LI");r.classList.add("fa-solid"),r.classList.add("fa-plus");const i=document.createElement("DIV");i.classList.add("botonesBox"),i.append(r);const l=document.createElement("DIV");l.classList.add("servicio"),l.dataset.id=c,l.append(s,o,i),document.querySelector("#servicios").appendChild(l),r.addEventListener("click",()=>{(e=t.servicios[""+c])?(delete t.servicios[""+c],r.classList.remove("fa-minus"),r.classList.add("fa-plus"),l.classList.remove("azul")):(t.servicios[""+c]={nombre:a,precio:n},r.classList.remove("fa-plus"),r.classList.add("fa-minus"),l.classList.add("azul"))})})}function u(){const e=document.querySelector("#fecha");t.fecha=e.value,e.addEventListener("input",()=>{const c=new Date(e.value).getUTCDay();[6,0].includes(c)?(e.value="",p("Fines de semana no permitidos","err","#paso-2 p")):t.fecha=e.value})}function m(){const e=document.querySelector("#hora");t.hora=e.value,e.addEventListener("input",()=>{let c=e.value;c=c.split(":"),c[0]<=10||c[0]>=18?(e.value="",p("Selecciona una hora entre las 10am y las 6pm","err","#paso-2 p")):t.hora=e.value})}function p(e,t,c,a=!0){const n=document.querySelector(".alert");n&&n.remove();const s=document.createElement("DIV");s.classList.add("alert");const o=document.createElement("DIV");o.textContent=e,o.classList.add(t),s.appendChild(o),document.querySelector(""+c).appendChild(s),a&&setTimeout(()=>{s.remove()},3e3)}function v(){const e=document.querySelector(".resumen");for(;e.firstChild;)e.removeChild(e.firstChild);(Object.values(t).includes("")||0===Object.keys(t.servicios).length)&&p("Hacen falta datos o servicios","err",".resumen",!1);const{nombre:c,fecha:a,hora:n,servicios:s}=t,o=new Date(a),r=o.getMonth(),i=o.getDate()+2,l=o.getFullYear(),d=new Date(Date.UTC(l,r,i)).toLocaleDateString("es-MX",{day:"numeric",weekday:"long",year:"numeric",month:"long"}),u=document.createElement("P");u.innerHTML="<span>Nombre:</span> "+c;const m=document.createElement("P");m.innerHTML="<span>Fecha:</span> "+("Invalid Date"!=d?d:"");const v=document.createElement("P");v.innerHTML="<span>Hora:</span> "+n;const L=document.createElement("DIV");L.classList.add("listado-servicios"),Object.keys(s).forEach(e=>{const t=document.createElement("DIV");t.classList.add("servicio");const c=document.createElement("P");c.classList.add("nombre-servicio"),c.textContent=""+s[e].nombre;const a=document.createElement("P");a.classList.add("precio-servicio"),a.textContent=""+s[e].precio,t.append(c,a),L.appendChild(t)});const h=document.createElement("BUTTON");h.classList.add("boton"),h.textContent="Reservar",h.addEventListener("click",f),e.append(u,m,v,L,h)}async function f(){if(Object.values(t).includes("")||0===Object.keys(t.servicios).length)p("Llena todos los campos antes de realizar la reservaciÃ³n","err","#paso-3");else{const{id:e,fecha:c,hora:a,servicios:n}=t,s=Object.keys(n).map(e=>e),o=new FormData;o.append("id_usuario",e),o.append("fecha",c),o.append("hora",a+":00"),o.append("servicios",s),console.log([...o]);try{const e="/api/citas",t=await fetch(e,{method:"POST",body:o});await t.json()&&Swal.fire({icon:"success",title:"Cita Creada",text:"Tu cita fue creada correctamente"}).then(()=>{setTimeout(()=>{window.location.reload()},3e3)})}catch(e){Swal.fire({icon:"error",title:"Oops...",text:"Hubo un error al reservar la cita"})}}}c();
//# sourceMappingURL=citas.js.map
